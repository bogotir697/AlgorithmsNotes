#### [[Вопросы к Экзамену]]
---
Новый ключ при добавлении всегда помещается в листовой узел, где он должен занять своё место (сохраняя упорядоченность элементов). Но нужный узел может быть уже заполнен, поэтому необходимо уметь разбивать такой узел надвое. Примерный алгоритм выглядит следующим образом (при этом явно запретим дубликаты ключей):
1. Осуществить поиск ключа в дереве.
2. Если ключ не найден и текущий узел листовой, то добавить ключ на позицию таким образом, чтобы сохранить упорядоченность ключей в узле.
3. Если до добавления узел уже являлся полным, то после операции вставки нарушается ограничение на количество ключей в узле, и необходимо выполнить операцию разбиения узла на 2.
#### Разбиение узла
![[Btree-nodeSplit.png]]После разбиения в случае, когда родительский узел также оказывается заполненным, то операция разбиения выполняется и для родительского узла. Если таким узлом оказывается корневой, тогда разделение завершается после очередного разделения с созданием нового корневого узла с единственным ключом. Таким образом, B-дерево растёт снизу-вверх.
#### Пример вставки
![[Btree-insertExample.png]]